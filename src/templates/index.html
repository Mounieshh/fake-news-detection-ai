<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fake News Detector</title>
    <style>
      :root {
        --primary-color: #3b82f6;
        --bg-color: #0f172a;
        --text-color: #e2e8f0;
        --surface-color: #1e293b;
        --border-color: #334155;
        --hover-color: #2563eb;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        background-color: var(--bg-color);
        color: var(--text-color);
        line-height: 1.6;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 2rem;
        width: 100%;
      }

      header {
        text-align: center;
        margin-bottom: 2rem;
      }

      h1 {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 1rem;
        background: linear-gradient(135deg, #3b82f6, #2563eb);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .input-section {
        background-color: var(--surface-color);
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 2rem;
        border: 1px solid var(--border-color);
      }

      .input-tabs {
        display: flex;
        gap: 1rem;
        margin-bottom: 1rem;
      }

      .tab-button {
        padding: 0.5rem 1rem;
        background: none;
        border: none;
        color: var(--text-color);
        cursor: pointer;
        border-radius: 6px;
        transition: background-color 0.2s;
      }

      .tab-button.active {
        background-color: var(--primary-color);
      }

      .tab-button:hover:not(.active) {
        background-color: var(--hover-color);
      }

      .input-content > div {
        display: none;
      }

      .input-content > div.active {
        display: block;
      }

      textarea,
      input[type="url"] {
        width: 100%;
        padding: 1rem;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        background-color: var(--bg-color);
        color: var(--text-color);
        margin-bottom: 1rem;
        font-size: 1rem;
        resize: vertical;
        min-height: 150px;
      }

      input[type="url"] {
        min-height: auto;
      }

      input[type="file"] {
        display: none;
      }

      .file-upload-label {
        display: block;
        padding: 1rem;
        background-color: var(--bg-color);
        border: 2px dashed var(--border-color);
        border-radius: 6px;
        text-align: center;
        cursor: pointer;
        margin-bottom: 1rem;
        transition: border-color 0.2s;
      }

      .file-upload-label:hover {
        border-color: var(--primary-color);
      }

      button {
        background-color: var(--primary-color);
        color: white;
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 6px;
        cursor: pointer;
        font-size: 1rem;
        transition: background-color 0.2s;
      }

      button:hover {
        background-color: var(--hover-color);
      }

      .result-section {
        background-color: var(--surface-color);
        border-radius: 12px;
        padding: 1.5rem;
        border: 1px solid var(--border-color);
        display: none;
      }

      .result-section.active {
        display: block;
      }

      .prediction-box {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1rem;
        padding: 1rem;
        border-radius: 6px;
        background-color: var(--bg-color);
      }

      .prediction-label {
        font-size: 1.2rem;
        font-weight: 600;
      }

      .prediction-fake {
        color: #ef4444;
      }

      .prediction-real {
        color: #22c55e;
      }

      .confidence-bar {
        height: 4px;
        background-color: var(--border-color);
        border-radius: 2px;
        overflow: hidden;
        margin: 0.5rem 0;
      }

      .confidence-fill {
        height: 100%;
        background-color: var(--primary-color);
        transition: width 0.3s ease;
      }

      .explanation {
        margin-top: 1rem;
        padding: 1rem;
        background-color: var(--bg-color);
        border-radius: 6px;
      }

      .red-flags {
        margin-top: 1rem;
      }

      .red-flag-item {
        color: #ef4444;
        margin-bottom: 0.5rem;
      }

      .loading {
        display: none;
        text-align: center;
        margin: 2rem 0;
      }

      .loading.active {
        display: block;
      }

      .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid var(--border-color);
        border-top: 4px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      footer {
        margin-top: auto;
        text-align: center;
        padding: 2rem;
        color: var(--text-color);
        opacity: 0.7;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>Fake News Detector</h1>
        <p>
          Analyze news content using advanced AI for authenticity verification
        </p>
      </header>

      <div class="input-section">
        <div class="input-tabs">
          <button class="tab-button active" data-tab="text">Text</button>
          <button class="tab-button" data-tab="url">URL</button>
          <button class="tab-button" data-tab="image">Image</button>
        </div>

        <form id="analyzer-form" enctype="multipart/form-data">
          <div class="input-content">
            <div class="tab-content active" id="text-input">
              <textarea
                name="text"
                placeholder="Paste news article text here..."
              ></textarea>
            </div>
            <div class="tab-content" id="url-input">
              <input
                type="url"
                name="url"
                placeholder="Enter news article URL..."
              />
            </div>
            <div class="tab-content" id="image-input">
              <label class="file-upload-label" for="image-upload">
                <span>Click to upload or drag and drop an image</span>
                <input
                  type="file"
                  id="image-upload"
                  name="image"
                  accept="image/*"
                />
              </label>
              <div id="image-preview"></div>
            </div>
          </div>
          <button type="submit">Analyze</button>
        </form>
      </div>

      <div class="loading">
        <div class="spinner"></div>
        <p>Analyzing content...</p>
      </div>

      <div class="result-section">
        <div class="prediction-box">
          <div>
            <div class="prediction-label">
              Prediction: <span id="prediction"></span>
            </div>
            <div class="confidence-bar">
              <div class="confidence-fill" id="confidence-fill"></div>
            </div>
            <div>Confidence: <span id="confidence"></span>%</div>
          </div>
        </div>

        <div class="explanation">
          <h3>Analysis Explanation:</h3>
          <p id="explanation"></p>
        </div>

        <div class="red-flags">
          <h3>Potential Issues:</h3>
          <ul id="red-flags-list"></ul>
        </div>
      </div>
    </div>

    <footer>
      <p>Powered by AI &middot; For educational purposes only</p>
    </footer>

    <script>
      // Tab switching
      document.querySelectorAll(".tab-button").forEach((button) => {
        button.addEventListener("click", () => {
          document
            .querySelectorAll(".tab-button")
            .forEach((b) => b.classList.remove("active"));
          document
            .querySelectorAll(".tab-content")
            .forEach((c) => c.classList.remove("active"));
          button.classList.add("active");
          document
            .getElementById(`${button.dataset.tab}-input`)
            .classList.add("active");
        });
      });

      // Form submission
      document
        .getElementById("analyzer-form")
        .addEventListener("submit", async (e) => {
          e.preventDefault();
          const form = e.target;
          const activeTab =
            document.querySelector(".tab-button.active").dataset.tab;
          const formData = new FormData(form);

          // Clear any existing form data for inactive tabs
          if (activeTab !== "text") formData.delete("text");
          if (activeTab !== "url") formData.delete("url");
          if (activeTab !== "image") formData.delete("image");

          document.querySelector(".loading").classList.add("active");
          document.querySelector(".result-section").classList.remove("active");

          try {
            const response = await fetch("/analyze", {
              method: "POST",
              body: formData,
            });

            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }

            const result = await response.json();
            if (result.error) {
              throw new Error(result.error);
            }

            displayResults(result);
          } catch (error) {
            console.error("Error:", error);
            alert(
              error.message ||
                "An error occurred during analysis. Please try again."
            );
          } finally {
            document.querySelector(".loading").classList.remove("active");
          }
        });

      // Display results
      function displayResults(result) {
        document.getElementById("prediction").textContent = result.prediction;
        document.getElementById("prediction").className =
          result.prediction === "FAKE" ? "prediction-fake" : "prediction-real";

        const confidence = Math.round(result.probability * 100);
        document.getElementById("confidence").textContent = confidence;
        document.getElementById(
          "confidence-fill"
        ).style.width = `${confidence}%`;

        document.getElementById("explanation").textContent = result.explanation;

        const flagsList = document.getElementById("red-flags-list");
        flagsList.innerHTML = "";
        result.red_flags.forEach((flag) => {
          const li = document.createElement("li");
          li.textContent = flag;
          li.className = "red-flag-item";
          flagsList.appendChild(li);
        });

        document.querySelector(".result-section").classList.add("active");
      }

      // Image preview
      document
        .getElementById("image-upload")
        .addEventListener("change", (e) => {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
              const preview = document.getElementById("image-preview");
              preview.innerHTML = `<img src="${e.target.result}" style="max-width: 100%; max-height: 300px; margin-top: 1rem;">`;
            };
            reader.readAsDataURL(file);
          }
        });
    </script>
  </body>
</html>
